<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω–∫–∞ ‚Äî –§–µ—Å—Ç–∏–≤–∞–ª—å –§–∏–≥–∞—Ä–æ</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        body {
            background: #f6f7fb;
            font-family: 'Segoe UI', 'Arial', sans-serif;
            margin: 0;
        }
        .admin-container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 30px;
            background: white;
            border-radius: 18px;
            box-shadow: 0 8px 32px rgba(60,60,120,0.08);
        }
        .admin-header {
            margin-bottom: 30px;
        }
        .admin-nav-flex {
            display: flex;
            gap: 18px;
            flex-wrap: nowrap;
            align-items: center;
            position: relative;
            overflow-x: auto;
            padding-bottom: 4px;
        }
        .admin-menu-btn {
            background: #667eea;
            color: white;
            padding: 10px 28px;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 500;
            font-size: 1.08em;
            border: none;
            transition: background 0.18s, color 0.18s;
            display: inline-block;
            text-align: center;
            cursor: pointer;
            white-space: nowrap;
        }
        .admin-menu-btn:hover, .admin-menu-btn.active {
            background: #4f5bd5;
            color: #fff;
        }
        /* –£–¥–∞–ª–µ–Ω—ã —Å—Ç–∏–ª–∏ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ –º–µ–Ω—é, —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—â–∏–π style.css */
        .admin-menu-dropdown-arrow {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            width: 24px;
            height: 12px;
            pointer-events: none;
            z-index: 1003;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px);}
            to { opacity: 1; transform: translateY(0);}
        }
        .admin-summary {
            margin-top: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 24px;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–∞–∑–¥–µ–ª–æ–≤ */
        .admin-section {
            margin-bottom: 40px;
        }
        .admin-section-title {
            font-size: 1.5em;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e7ff;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .admin-section-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        .summary-card {
            background: linear-gradient(135deg, #e0e7ff 0%, #f0f4ff 100%);
            border-radius: 12px;
            padding: 14px 10px;
            box-shadow: 0 2px 8px rgba(102,126,234,0.07);
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 110px;
        }
        .summary-card h3 {
            margin: 0 0 8px 0;
            font-size: 1.18em;
            color: #667eea;
            font-weight: 600;
        }
        .summary-card p {
            margin: 0;
            font-size: 2.1em;
            font-weight: bold;
            color: #222;
        }
        .profile-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            background: #f4f6fb;
            border-radius: 14px;
            box-shadow: 0 2px 8px rgba(60,60,120,0.06);
            padding: 10px 6px 8px 6px;
            min-width: 140px;
            min-height: 110px;
        }
        .profile-avatar {
            font-size: 1.3em;
            background: #e0e7ff;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 2px;
        }
        .profile-info {
            text-align: center;
        }
        .profile-name {
            font-weight: 600;
            color: #4f5bd5;
            font-size: 1em;
        }
        .profile-role {
            font-size: 0.9em;
            color: #8ca0c7;
            margin-bottom: 2px;
        }
        .profile-link {
            margin-top: 6px;
            color: #4f5bd5;
            text-decoration: underline;
            font-weight: 500;
            transition: color 0.18s;
        }
        .profile-link:hover {
            color: #1e88e5;
        }
        .profile-card:hover {
            background: rgba(255,193,7,0.22);
            box-shadow: 0 2px 12px rgba(255,193,7,0.13);
            text-decoration: none;
        }
        .summary-card:not(.profile-card):hover {
            background: #e0e7ff;
            box-shadow: 0 2px 12px rgba(76, 110, 245, 0.10);
            text-decoration: none;
        }
        @media (max-width: 900px) {
            .admin-nav-flex { gap: 8px; }
            .admin-menu-btn, .admin-menu-dropdown-btn { padding: 10px 12px; font-size: 1em; }
            .admin-menu-dropdown-content { min-width: 120px; }
            .admin-summary { 
                grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); 
                gap: 16px; 
            }
        }
    </style>
</head>
<body>

    <div class="admin-container">
        {% block content %}
        <div class="admin-header" style="display: flex; align-items: center; justify-content: space-between; gap: 24px;">
            <h1 style="font-size:2.2em; margin:0; flex-shrink:0;">–ê–¥–º–∏–Ω–∫–∞ —Ñ–µ—Å—Ç–∏–≤–∞–ª—è</h1>
            <nav class="admin-nav-flex" id="adminNav" style="flex:1;">
                <a href="/admin" class="admin-menu-btn">–ì–ª–∞–≤–Ω–∞—è</a>
                <a href="/admin/users" class="admin-menu-btn">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
                <a href="/admin/customers" class="admin-menu-btn">–ü–æ–∫—É–ø–∞—Ç–µ–ª–∏</a>
                <a href="/admin/purchases" class="admin-menu-btn">–ü–æ–∫—É–ø–∫–∏</a>
                <a href="/admin/concerts" class="admin-menu-btn">–ö–æ–Ω—Ü–µ—Ä—Ç—ã</a>
                <a href="/admin/halls" class="admin-menu-btn">–ó–∞–ª—ã</a>
                <a href="/admin/routes" class="admin-menu-btn">–ú–∞—Ä—à—Ä—É—Ç—ã</a>
                <a href="/admin/offprogram" class="admin-menu-btn">–û—Ñ—Ñ-–ø—Ä–æ–≥—Ä–∞–º–º–∞</a>
                <a href="/admin/artists" class="admin-menu-btn">–ê—Ä—Ç–∏—Å—Ç—ã</a>
                <a href="/admin/authors" class="admin-menu-btn">–ê–≤—Ç–æ—Ä—ã</a>
                <a href="/admin/compositions" class="admin-menu-btn">–ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è</a>
                <a href="/admin/genres" class="admin-menu-btn">–ñ–∞–Ω—Ä—ã</a>
                <a href="/admin/telegram" class="admin-menu-btn">–†–∞—Å—Å—ã–ª–∫–∞ Telegram</a>
                <a href="/" class="admin-menu-btn"><span style="font-size:1.1em; margin-right:6px;">ÔøΩÔøΩ</span>–ù–∞ —Å–∞–π—Ç</a>
                <div class="admin-menu-dropdown" id="adminMenuDropdown" style="display:none;">
                    <button class="admin-menu-dropdown-btn" id="dropdownBtn">–ï—â—ë <span style="font-size:1.1em;">‚ñº</span></button>
                    <div class="admin-menu-dropdown-content" id="dropdownContent">
                        <div class="admin-menu-dropdown-arrow">
                            <svg width="24" height="12"><polygon points="12,12 0,0 24,0" fill="#f0f4ff"/></svg>
                        </div>
                    </div>
                </div>
            </nav>
        </div>
        <div>
            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.name or user.email }}!</h2>
            <p>–≠—Ç–æ –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–¥–º–∏–Ω–∫–∏. –ó–¥–µ—Å—å –±—É–¥–µ—Ç —Å–≤–æ–¥–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ä–∞–∑–¥–µ–ª–∞–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.</p>
        </div>
        
        <!-- üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∞—É–¥–∏—Ç–æ—Ä–∏—è -->
        <div class="admin-section">
            <div class="admin-section-title">
                <span style="font-size: 1.3em;">üë•</span>
                –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∞—É–¥–∏—Ç–æ—Ä–∏—è
            </div>
            <div class="admin-section-grid">
                <a href="/admin/users" style="text-decoration:none; color:inherit;" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º">
                    <div class="summary-card" style="cursor:pointer;">
                        <h3>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                        <p>{{ summary.users_count }}</p>
                    </div>
                </a>
                <a href="/admin/customers" style="text-decoration:none; color:inherit;" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º">
                    <div class="summary-card" style="cursor:pointer;">
                        <h3>–ü–æ–∫—É–ø–∞—Ç–µ–ª–µ–π</h3>
                        <p>{{ summary.customers_count or 0 }}</p>
                    </div>
                </a>
                <a href="/admin/purchases" style="text-decoration:none; color:inherit;" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫—É–ø–æ–∫">
                    <div class="summary-card">
                        <h3>–ë–∏–ª–µ—Ç–æ–≤ –∫—É–ø–ª–µ–Ω–æ</h3>
                        <p>{{ summary.tickets_count }}</p>
                    </div>
                </a>
                <a href="/profile" style="text-decoration:none; color:inherit;" title="–ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ—Ñ–∏–ª—å">
                    <div class="summary-card profile-card" style="cursor:pointer; transition:box-shadow 0.18s, background 0.18s;">
                        <div class="profile-avatar">üëë </div>
                        <div class="profile-info">
                            <div class="profile-name">{{ user.name or user.email }}</div>
                            <div class="profile-role">–°—É–ø–µ—Ä–∞–¥–º–∏–Ω</div>
                        </div>
                    </div>
                </a>
            </div>
        </div>
        
        <!-- üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="admin-section">
            <div class="admin-section-title">
                <span style="font-size: 1.3em;">üìä</span>
                –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            </div>
            <div class="admin-section-grid">
                <div class="summary-card">
                    <h3>–°—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫</h3>
                    <p>{{ "{: }".format(summary.total_spent) }} ‚ÇΩ</p>
                </div>
                <div class="summary-card">
                    <h3>–°—Ä–µ–¥–Ω—è—è –∑–∞–ø–æ–ª–Ω—è–µ–º–æ—Å—Ç—å</h3>
                    <p>{{ '%.2f' % summary.avg_fill }}</p>
                </div>
                <a href="/admin/routes/view" style="text-decoration:none; color:inherit;" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ –º–∞—Ä—à—Ä—É—Ç–∞–º">
                    <div class="summary-card" style="cursor:pointer;">
                        <h3>–ú–∞—Ä—à—Ä—É—Ç–æ–≤</h3>
                        <p>{{ routes_count }}</p>
                    </div>
                </a>
                <div class="summary-card" style="background: linear-gradient(135deg, #e8f5e8 0%, #f0fff0 100%);">
                    <h3>–ö–æ–Ω—Ü–µ—Ä—Ç–æ–≤ –≤ –ø—Ä–æ–¥–∞–∂–µ</h3>
                    <p>{{ summary.available_concerts_count or 0 }}</p>
                    <small style="color: #666; font-size: 0.85em;">–∏–∑ {{ summary.concerts_count or 0 }}</small>
                </div>
                <div class="summary-card" style="background: linear-gradient(135deg, #e8f5e8 0%, #f0fff0 100%);">
                    <h3>–î–æ—Å—Ç—É–ø–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤</h3>
                    <p>{{ summary.available_routes_count or 0 }}</p>
                    <small style="color: #666; font-size: 0.85em;">–∏–∑ {{ summary.routes_count or 0 }}</small>
                </div>
            </div>
        </div>
        
        <!-- üéµ –ö–æ–Ω—Ç–µ–Ω—Ç —Ñ–µ—Å—Ç–∏–≤–∞–ª—è -->
        <div class="admin-section">
            <div class="admin-section-title">
                <span style="font-size: 1.3em;">üéµ</span>
                –ö–æ–Ω—Ç–µ–Ω—Ç —Ñ–µ—Å—Ç–∏–≤–∞–ª—è
            </div>
            <div class="admin-section-grid">
                <a href="/admin/concerts" style="text-decoration:none; color:inherit;" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ –∫–æ–Ω—Ü–µ—Ä—Ç–∞–º">
                    <div class="summary-card" style="cursor:pointer;">
                        <h3>–ö–æ–Ω—Ü–µ—Ä—Ç–æ–≤</h3>
                        <p>{{ summary.concerts_count }}</p>
                    </div>
                </a>
                <a href="/admin/halls" style="text-decoration:none; color:inherit;" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ –∑–∞–ª–∞–º">
                    <div class="summary-card" style="cursor:pointer;">
                        <h3>–ó–∞–ª–æ–≤</h3>
                        <p>{{ summary.halls_count }}</p>
                    </div>
                </a>
                <a href="/admin/artists" style="text-decoration:none; color:inherit;" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ –∞—Ä—Ç–∏—Å—Ç–∞–º">
                    <div class="summary-card" style="cursor:pointer;">
                        <h3>–ê—Ä—Ç–∏—Å—Ç–æ–≤</h3>
                        <p>{{ summary.artists_count or 0 }}</p>
                    </div>
                </a>
                <a href="/admin/authors" style="text-decoration:none; color:inherit;" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ –∞–≤—Ç–æ—Ä–∞–º">
                    <div class="summary-card" style="cursor:pointer;">
                        <h3>–ê–≤—Ç–æ—Ä–æ–≤</h3>
                        <p>{{ summary.authors_count or 0 }}</p>
                    </div>
                </a>
                <a href="/admin/compositions" style="text-decoration:none; color:inherit;" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è–º">
                    <div class="summary-card" style="cursor:pointer;">
                        <h3>–ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π</h3>
                        <p>{{ summary.compositions_count or 0 }}</p>
                    </div>
                </a>
                <a href="/admin/genres" style="text-decoration:none; color:inherit;" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ –∂–∞–Ω—Ä–∞–º">
                    <div class="summary-card" style="cursor:pointer;">
                        <h3>–ñ–∞–Ω—Ä–æ–≤</h3>
                        <p>{{ summary.genres_count or 0 }}</p>
                    </div>
                </a>
                <a href="/admin/offprogram" style="text-decoration:none; color:inherit;" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ—Ñ—Ñ-–ø—Ä–æ–≥—Ä–∞–º–º–µ">
                    <div class="summary-card" style="cursor:pointer;">
                        <h3>–û—Ñ—Ñ-–ø—Ä–æ–≥—Ä–∞–º–º–∞</h3>
                        <p>{{ summary.off_program_count or 0 }}</p>
                    </div>
                </a>
            </div>
        </div>
        
        <!-- üõ†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ -->
        <div class="admin-section">
            <div class="admin-section-title">
                <span style="font-size: 1.3em;">üõ†Ô∏è</span>
                –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
            </div>
            <div class="admin-section-grid">
                <a href="/admin/telegram" style="text-decoration:none; color:inherit;" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ä–∞—Å—Å—ã–ª–∫–µ Telegram">
                    <div class="summary-card" style="cursor:pointer;">
                        <h3>üì± Telegram —Ä–∞—Å—Å—ã–ª–∫–∞</h3>
                        <p>–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π</p>
                    </div>
                </a>
                <a href="http://localhost:5555" target="_blank" style="text-decoration:none; color:inherit;" title="–û—Ç–∫—Ä—ã—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Celery">
                    <div class="summary-card" style="cursor:pointer;">
                        <h3>‚ö° –û—á–µ—Ä–µ–¥–∏ Celery</h3>
                        <p>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–¥–∞—á</p>
                    </div>
                </a>
                <a href="http://localhost:8080" target="_blank" style="text-decoration:none; color:inherit;" title="–û—Ç–∫—Ä—ã—Ç—å Adminer">
                    <div class="summary-card" style="cursor:pointer;">
                        <h3>üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
                        <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ë–î</p>
                    </div>
                </a>
            </div>
        </div>

        <!-- üìà –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
        <div class="admin-section">
            <div class="admin-section-title">
                <span style="font-size: 1.3em;">üìà</span>
                –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
            </div>
            <div class="admin-section-grid">
                <a href="/admin/analytics/sales" style="text-decoration:none; color:inherit;" title="–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥–∞–∂">
                    <div class="summary-card" style="cursor:pointer; background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);">
                        <h3>üìä –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥–∞–∂</h3>
                        <p>–ì—Ä–∞—Ñ–∏–∫–∏ –∏ —Ç—Ä–µ–Ω–¥—ã</p>
                        <small style="color: #666; font-size: 0.85em;">–î–∏–Ω–∞–º–∏–∫–∞ –ø–æ –¥–Ω—è–º</small>
                    </div>
                </a>
                <a href="/admin/analytics/halls" style="text-decoration:none; color:inherit;" title="–ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –∑–∞–ª–æ–≤">
                    <div class="summary-card" style="cursor:pointer; background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%);">
                        <h3>üèõÔ∏è –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –∑–∞–ª–æ–≤</h3>
                        <p>–¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞</p>
                        <small style="color: #666; font-size: 0.85em;">–ó–∞–ø–æ–ª–Ω—è–µ–º–æ—Å—Ç—å</small>
                    </div>
                </a>
                <a href="/admin/analytics/telegram" style="text-decoration:none; color:inherit;" title="Telegram —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞">
                    <div class="summary-card" style="cursor:pointer; background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);">
                        <h3>üì± Telegram –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h3>
                        <p>–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –±–æ—Ç–∞</p>
                        <small style="color: #666; font-size: 0.85em;">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∫–æ–º–∞–Ω–¥—ã</small>
                    </div>
                </a>
                <a href="/admin/analytics/routes" style="text-decoration:none; color:inherit;" title="–ê–Ω–∞–ª–∏–∑ –º–∞—Ä—à—Ä—É—Ç–æ–≤">
                    <div class="summary-card" style="cursor:pointer; background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);">
                        <h3>üó∫Ô∏è –ê–Ω–∞–ª–∏–∑ –º–∞—Ä—à—Ä—É—Ç–æ–≤</h3>
                        <p>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø—É—Ç–∏</p>
                        <small style="color: #666; font-size: 0.85em;">–ü–∞—Ç—Ç–µ—Ä–Ω—ã –ø–æ—Å–µ—â–µ–Ω–∏–π</small>
                    </div>
                </a>
            </div>
        </div>

        <!-- üîî –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
        <div class="admin-section">
            <div class="admin-section-title">
                <span style="font-size: 1.3em;">üîî</span>
                –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            </div>
            <div class="admin-section-grid">
                <div class="summary-card" style="background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);">
                    <h3>‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã</h3>
                    <p>{{ alerts.critical or 0 }}</p>
                    <small style="color: #666; font-size: 0.85em;">–¢—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è</small>
                </div>
                <div class="summary-card" style="background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%);">
                    <h3>üì¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
                    <p>{{ alerts.notifications or 0 }}</p>
                    <small style="color: #666; font-size: 0.85em;">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ</small>
                </div>
                <a href="/admin/telegram/stats" style="text-decoration:none; color:inherit;" title="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Telegram">
                    <div class="summary-card" style="cursor:pointer; background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);">
                        <h3>üì± Telegram —Ä–∞—Å—Å—ã–ª–∫–∏</h3>
                        <p>{{ telegram_stats.sent or 0 }}</p>
                        <small style="color: #666; font-size: 0.85em;">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è</small>
                    </div>
                </a>
                <a href="/admin/notifications/settings" style="text-decoration:none; color:inherit;" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π">
                    <div class="summary-card" style="cursor:pointer;">
                        <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                        <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</p>
                        <small style="color: #666; font-size: 0.85em;">–ê–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</small>
                    </div>
                </a>
            </div>
        </div>
        {% endblock %}
    </div>
    <script>
    // –ë—É—Ä–≥–µ—Ä-–º–µ–Ω—é –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
    function toggleSidebar() {
        document.getElementById('sidebar').classList.toggle('open');
    }
    document.addEventListener('DOMContentLoaded', function() {
        const burger = document.getElementById('burger');
        const sidebar = document.getElementById('sidebar');
        function checkMobile() {
            if (window.innerWidth <= 600) {
                burger.style.display = 'flex';
                sidebar.classList.remove('open');
            } else {
                burger.style.display = 'none';
                sidebar.classList.remove('open');
            }
        }
        burger.addEventListener('click', toggleSidebar);
        window.addEventListener('resize', checkMobile);
        checkMobile();
    });
    // –í—ã–ø–∞–¥–∞—é—â–µ–µ –º–µ–Ω—é –¥–ª—è –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è
    document.addEventListener('DOMContentLoaded', function() {
        const nav = document.getElementById('adminNav');
        const dropdown = document.getElementById('adminMenuDropdown');
        const dropdownBtn = document.getElementById('dropdownBtn');
        const dropdownContent = document.getElementById('dropdownContent');
        function updateDropdown() {
            // –°–±—Ä–æ—Å
            dropdownContent.innerHTML = '<div class="admin-menu-dropdown-arrow">\n<svg width="24" height="12"><polygon points="12,12 0,0 24,0" fill="#f0f4ff"/></svg>\n</div>';
            let linksWrapper = document.createElement('div');
            linksWrapper.className = 'admin-menu-dropdown-links';
            let navWidth = nav.offsetWidth;
            let total = 0;
            let overflowed = [];
            const children = Array.from(nav.children).filter(el => el.classList.contains('admin-menu-btn'));
            children.forEach(el => {
                el.style.display = '';
            });
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∫–∞–∫–∏–µ –∫–Ω–æ–ø–∫–∏ –Ω–µ –ø–æ–º–µ—â–∞—é—Ç—Å—è
            children.forEach(el => {
                const rect = el.getBoundingClientRect();
                const navRect = nav.getBoundingClientRect();
                if (rect.right > navRect.right - 120) { // 120px –∑–∞–ø–∞—Å –ø–æ–¥ dropdown
                    overflowed.push(el);
                }
            });
            if (overflowed.length > 0) {
                overflowed.forEach(el => {
                    let clone = el.cloneNode(true);
                    clone.classList.remove('admin-menu-btn');
                    if (clone.getAttribute('href') === '/') {
                        clone.innerHTML = '<span style="font-size:1.1em; margin-right:6px;">üåê</span>–ù–∞ —Å–∞–π—Ç';
                    } else {
                        clone.innerHTML = clone.textContent.trim();
                    }
                    linksWrapper.appendChild(clone);
                    el.style.display = 'none';
                });
                dropdownContent.appendChild(linksWrapper);
                dropdown.style.display = 'inline-block';
            } else {
                dropdown.style.display = 'none';
            }
        }
        window.addEventListener('resize', updateDropdown);
        updateDropdown();
        // –û—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ dropdown
        dropdownBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            dropdown.classList.toggle('open');
            if (dropdown.classList.contains('open')) {
                const btnRect = dropdownBtn.getBoundingClientRect();
                dropdownContent.style.left = btnRect.left + 'px';
                dropdownContent.style.top = (btnRect.bottom + 6) + 'px';
            }
        });
        document.body.addEventListener('click', function() {
            dropdown.classList.remove('open');
        });
    });
    
    // –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    document.addEventListener('DOMContentLoaded', function() {
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤
        function updateCounters() {
            fetch('/admin/api/dashboard-stats')
                .then(response => response.json())
                .then(data => {
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
                    if (data.alerts) {
                        const criticalEl = document.querySelector('.summary-card h3:contains("–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã")');
                        if (criticalEl) {
                            criticalEl.nextElementSibling.textContent = data.alerts.critical || 0;
                        }
                        
                        const notificationsEl = document.querySelector('.summary-card h3:contains("–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è")');
                        if (notificationsEl) {
                            notificationsEl.nextElementSibling.textContent = data.alerts.notifications || 0;
                        }
                    }
                    
                    if (data.telegram_stats) {
                        const telegramEl = document.querySelector('.summary-card h3:contains("Telegram —Ä–∞—Å—Å—ã–ª–∫–∏")');
                        if (telegramEl) {
                            telegramEl.nextElementSibling.textContent = data.telegram_stats.sent || 0;
                        }
                    }
                })
                .catch(error => console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', error));
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        setInterval(updateCounters, 30000);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∞–ª–µ—Ä—Ç–∞—Ö
        function checkAlerts() {
            fetch('/admin/api/alerts')
                .then(response => response.json())
                .then(data => {
                    if (data.critical && data.critical.length > 0) {
                        showAlertNotification(data.critical);
                    }
                })
                .catch(error => console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤:', error));
        }
        
        function showAlertNotification(alerts) {
            // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #dc3545;
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                max-width: 300px;
                animation: slideIn 0.3s ease-out;
            `;
            
            notification.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 8px;">‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã</div>
                <div style="font-size: 0.9em;">
                    ${alerts.slice(0, 2).map(alert => `‚Ä¢ ${alert.message}`).join('<br>')}
                    ${alerts.length > 2 ? `<br><small>...–∏ –µ—â–µ ${alerts.length - 2}</small>` : ''}
                </div>
                <button onclick="this.parentElement.remove()" style="
                    position: absolute;
                    top: 5px;
                    right: 5px;
                    background: none;
                    border: none;
                    color: white;
                    font-size: 18px;
                    cursor: pointer;
                ">√ó</button>
            `;
            
            document.body.appendChild(notification);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–±–∏—Ä–∞–µ–º —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 10000);
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–ª–µ—Ä—Ç—ã –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
        setInterval(checkAlerts, 60000);
        
        // –î–æ–±–∞–≤–ª—è–µ–º CSS –∞–Ω–∏–º–∞—Ü–∏–∏
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            .summary-card {
                transition: transform 0.2s ease, box-shadow 0.2s ease;
            }
            
            .summary-card:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            }
            
            .admin-section-title {
                position: relative;
            }
            
            .admin-section-title::after {
                content: '';
                position: absolute;
                bottom: -2px;
                left: 0;
                width: 0;
                height: 2px;
                background: linear-gradient(90deg, #667eea, #764ba2);
                transition: width 0.3s ease;
            }
            
            .admin-section:hover .admin-section-title::after {
                width: 100%;
            }
        `;
        document.head.appendChild(style);
    });
    </script>
</body>
</html> 