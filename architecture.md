# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Telegram-–±–æ—Ç–∞ —Å FastAPI, Celery –∏ RabbitMQ

## üìå –¶–µ–ª—å

–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É FastAPI –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–º –∏ Telegram-–±–æ—Ç–æ–º —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á, –∏—Å–ø–æ–ª—å–∑—É—è:
- **Celery** ‚Äî –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–∞—á
- **RabbitMQ** ‚Äî –∫–∞–∫ –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π
- **aiogram** ‚Äî –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å Telegram API
- **Docker** ‚Äî –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

---

## üß± –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí FastAPI ‚Üí Celery ‚Üí RabbitMQ ‚Üí Celery Worker ‚Üí Telegram Bot (aiogram) ‚Üí Telegram
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project/
‚îÇ
‚îú‚îÄ‚îÄ app/                   # FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ api.py
‚îÇ   ‚îî‚îÄ‚îÄ tasks.py           # –ò–º–ø–æ—Ä—Ç –∏ –≤—ã–∑–æ–≤ –∑–∞–¥–∞—á Celery
‚îÇ
‚îú‚îÄ‚îÄ worker/                # Celery worker
‚îÇ   ‚îú‚îÄ‚îÄ celery_worker.py
‚îÇ   ‚îî‚îÄ‚îÄ tasks.py           # –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–≤ —Ç.—á. —á–µ—Ä–µ–∑ aiogram)
‚îÇ
‚îú‚îÄ‚îÄ bot/                   # aiogram –±–æ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ bot.py             # Telegram Bot API –∏ –ª–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml
‚îî‚îÄ‚îÄ .env
```

---


---

## üê≥ –ü—Ä–∏–º–µ—Ä Dockerfile –¥–ª—è Celery Worker

```dockerfile
FROM python:3.10-slim

WORKDIR /worker

COPY ./worker /worker
COPY ./bot /bot

RUN pip install celery aiogram

CMD ["celery", "-A", "celery_worker", "worker", "--loglevel=info"]
```

---

## üì¶ .env —Ñ–∞–π–ª

```
TELEGRAM_TOKEN=your_actual_token
```

---

## üß† –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –û–±–æ—Ä–∞—á–∏–≤–∞–π `send_telegram_message` –≤ retry-–ª–æ–≥–∏–∫—É –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, 429 –æ—Ç Telegram).
- –ò—Å–ø–æ–ª—å–∑—É–π `Flower` (`pip install flower`) –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∑–∞–¥–∞—á Celery.
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `crontab`/`periodic` –∑–∞–¥–∞—á–∏ –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π.
