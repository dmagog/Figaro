# Структура проекта

*На старте это черновой файл, который в себя собирает размышления, стратегию и перспективные планы, которые касаются структуры проекта. Здесь хочется выработать блоки и очередность работы, реализацию технологического стека и просто не запутаться, что откуда берется и куда девается, с учетом предыдущих исследований и MVP.*



## Общие вводные

Figaro - конструктор маршрутов фестиваля «Безумные дни»

## Структура проекта

1. Исследование и сбор датасета
    * Сбор данных
    * Очистка и обогащение
    * [ ] Получаем на выходе данные для СУБД

    * выгрузка историй операций посетителей филармонии
    * ежедневная проверка кто-какой маршрут сформировал (соотнесем с действующими маршрутами, соберем рейтинг)

2. Генерация возможных маршрутов

Оркестрация вызовов и отчистки данных из файлов --> Создаем таблицы в СУБД (раз в N минут проверяем количество доступных билетов)
Тут ключевое: данные откуда-то беруться (не суть важно) --> Мы получаем чистые вводные в виде таблиц СУБД (концерты, артисты, авторы, произведения)
Вносим дополнительную разметку концертов: концерты дубли, семейные, детские, звездные, одобрены редакцией и пр. "Главные концерт дня"

Сетка переходов между залами
Ссылки на концерты, на артистов


Считаем концерты, которые пересекаются по времени начала и длительности
Строим матрицу расстояния во времени между концертами
Отбираем сочетания концертов, которые не релевантны с учетом нахлеста длительности и учитывая матрицу переходов.
Генерация всех реалистичных сочетаний концертов одного дня
Генерация маршрутов сквозь дни

Формирование характеристического портрета маршрута на основе данных о концертах
Обогащение характеристического портрета специальными метками (рекомендательные маршруты сгаф, авторсике маргруты и тп.)

ML_1: построить какие то эмбэндинги концертов (через программы или через артистов), чтобы через это оценить ценность
ML_2: подготовить описание маршута через LLM

API
* Проверка жизнеспособности сервиса
* проверка доступности СУБД
* Запрос подборок маршрутоа по фильтру
    * Запрос "самых-самых" маршрутов
    * Запрос характеристик концерта
    * Запрос концертов артиста + дни
    * запрос концертов по залам + дни
    * запрос концертов по композиторам
    * запрос концертов по залам
    * проверка доступности маршрута (непроданности билетов)
    * Создание описание маршрута по его параметрам
        * по шаблону
        * через промпт LLM
* Отправить маршрут на почту
* Админское волшебство:
    * снять разрешение на продажу перечня концертов
    * сгенерировать случайное количество свободных мест на концертах
    * назначить метку "рекомендаци" концерту, артисту, произведению, маршруту

* ЛК пользователя
    * (?) Добавить маршрут в Личное избранное
    * ML_3: Отметить концерты, которые уже купил (для дальнейших рекомендаций) 
    * отметить что точно "да", что точно "нет"
* Экспорт маршрута
    * Краткий экспорт (для промо, напрмиер)
    * Экспорт на почту пользователя
    * Оформление ЛФА по перечню концертов (отправка заявки или использование API внешнего сервиса)
* Ранжирование:
    * запись в базу метрики. сколько человек выбрали этот маршрут (по анализу данных о продажах)
    * рейтинг самых популярных маршрутов среди купленных ~~ среди добавленных в избранное ~~
    * как меняласся рейтинг маршрутов день ото дня
    * как менялся рейтинг маршрутов по длительности день ото дня
    * на сколько твой маршрут рекомендован (соотнести свой маршрут с маршрутами экспертов и прочей рекомендацией)

### Технический стек
Питон, оркестрация очистки в Airflow. версионирование экспериментов в ML flow (?)
